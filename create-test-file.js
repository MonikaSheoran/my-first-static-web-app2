const fs = require('fs');

// Create a minimal valid XLSX file
const xlsxHeader = Buffer.from([
    0x50, 0x4B, 0x03, 0x04, // ZIP file signature
    0x14, 0x00, 0x00, 0x00, 0x08, 0x00, // ZIP header
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x09, 0x00, 0x00, 0x00, // filename length
    ...Buffer.from('test.xlsx'), // filename
    ...Buffer.from('test excel content for debugging upload'),
    0x50, 0x4B, 0x05, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
]);

fs.writeFileSync('test-upload.xlsx', xlsxHeader);
console.log('Test Excel file created: test-upload.xlsx');
console.log('File size:', fs.statSync('test-upload.xlsx').size, 'bytes');
